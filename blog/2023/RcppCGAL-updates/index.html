<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> RcppCGAL updated | Eric A. Dunipace </title> <meta name="author" content="Eric A. Dunipace"> <meta name="description" content="RcppCGAL has undergone some updates! "> <meta name="keywords" content="Dunipace, Eric, optimal, transport, optimal transport, Harvard, UCLA, DGSOM, Berkeley, Stanford, psychiatry, biostats, biostatistics, statistics, stats, machine learning, Zubizarreta, Trippa, Eric Dunipace, causal, inference"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?5b15871aca489a433d98b6c24c83b78b"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ericdunipace.github.io/blog/2023/RcppCGAL-updates/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Eric</span> A. Dunipace </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">RcppCGAL updated</h1> <p class="post-meta"> Created in May 29, 2023 </p> <p class="post-tags"> <a href="/blog/2023"> <i class="fa-solid fa-calendar fa-sm"></i> 2023 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>I’ve done some fairly extensive changes to the <a href="https://github.com/ericdunipace/RcppCGAL" rel="external nofollow noopener" target="_blank">RcppCGAL package</a>, but since this is probably the first time I’ve described it, I should back up a little bit and maybe describe what it does and answer any other anticipated questions you may have.</p> <h2 id="what-does-cgal-stand-for">What does CGAL stand for?</h2> <p>CGAL stands for the Computational Geometry Algorithms Library. You can read more about it <a href="https://www.cgal.org" rel="external nofollow noopener" target="_blank">here</a>.</p> <h2 id="why-have-you-done-this">Why have you done this?</h2> <p>Basically, I did this because I needed the <a href="https://doc.cgal.org/latest/Spatial_sorting/index.html#sechilbert_sorting" rel="external nofollow noopener" target="_blank">Hilbert sorting</a> function from CGAL for the <a href="https://arxiv.org/abs/2012.09999" rel="external nofollow noopener" target="_blank">first paper</a> of my <a href="https://dash.harvard.edu/handle/1/37368342" rel="external nofollow noopener" target="_blank">thesis</a>. It seemed like there could be a need for others to use these header files, so I made a package.</p> <h2 id="what-software-is-it-for">What software is it for?</h2> <p>Anything running in R in need of some C/C++ header files.</p> <h2 id="what-changes-have-you-made">What changes have you made?</h2> <p>The package will try to download the latest header files and will then change the C code to make sure that any messages are printed to the R console and that any errors and stop signals are handled appropriately so that R doesn’t crash.</p> <p>In this specific version, I’ve added a function <code class="language-plaintext highlighter-rouge">cgal_install</code> to download the header files and change the outputs. This will hopefully make it easier to update the header files but also will allow users to install the header files when the automatic download on install doesn’t work.</p> <h2 id="how-do-i-use-it">How do I use it?</h2> <p>Really, this is a bare bones package simply meant to make the process of including the latest CGAL header files into an R package easier. To use it you just need to install the package in the usual manner from R: <code class="language-plaintext highlighter-rouge">install.packages("RcppCGAL")</code>. You can also use the <code class="language-plaintext highlighter-rouge">remotes</code> package to download directly from GitHub. There’s a vignette in the package that also describes how to install the header files.</p> <p>To see what kinds of things are possible with CGAL, I recommend checking out Stéphane Laurent’s packages. He details some of them <a href="https://laustep.github.io/stlahblog/posts/SurfaceReconstruction.html" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>From my own uses, I have the following example in the README file of the GitHub on how to do Hilbert sorting</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// [[Rcpp::depends(RcppCGAL)]]</span>
<span class="c1">// [[Rcpp::depends(BH)]]</span>
<span class="c1">// [[Rcpp::depends(RcppEigen)]]</span>
<span class="c1">// [[Rcpp::plugins(cpp14)]]  </span>

<span class="cp">#include</span> <span class="cpf">&lt;RcppEigen.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;CGAL/basic.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;CGAL/Cartesian_d.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;CGAL/spatial_sort.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;CGAL/Spatial_sort_traits_adapter_d.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;CGAL/boost/iterator/counting_iterator.hpp&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;CGAL/hilbert_sort.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;CGAL/Spatial_sort_traits_adapter_d.h&gt;</span><span class="cp">
</span>
<span class="k">typedef</span> <span class="n">CGAL</span><span class="o">::</span><span class="n">Cartesian_d</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span>           <span class="n">Kernel</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">Kernel</span><span class="o">::</span><span class="n">Point_d</span>                     <span class="n">Point_d</span><span class="p">;</span>

<span class="k">typedef</span> <span class="n">CGAL</span><span class="o">::</span><span class="n">Spatial_sort_traits_adapter_d</span><span class="o">&lt;</span><span class="n">Kernel</span><span class="p">,</span> <span class="n">Point_d</span><span class="o">*&gt;</span>   <span class="n">Search_traits_d</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">hilbert_sort_cgal_fun</span><span class="p">(</span><span class="k">const</span> <span class="kt">double</span> <span class="o">*</span> <span class="n">A</span><span class="p">,</span> <span class="kt">int</span> <span class="n">D</span><span class="p">,</span> <span class="kt">int</span> <span class="n">N</span><span class="p">,</span>  <span class="kt">int</span> <span class="o">*</span> <span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
  
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point_d</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
  <span class="kt">double</span> <span class="o">*</span> <span class="n">temp</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">double</span><span class="p">[</span><span class="n">D</span><span class="p">];</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">D</span><span class="p">;</span> <span class="n">d</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">temp</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">D</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">d</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">v</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">Point_d</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">temp</span><span class="o">+</span><span class="n">D</span><span class="p">));</span>
  <span class="p">}</span>
  
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">ptrdiff_t</span><span class="o">&gt;</span> <span class="n">temp_index</span><span class="p">;</span>
  <span class="n">temp_index</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
  
  <span class="n">std</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span>
    <span class="n">boost</span><span class="o">::</span><span class="n">counting_iterator</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">ptrdiff_t</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">boost</span><span class="o">::</span><span class="n">counting_iterator</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kt">ptrdiff_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">()),</span>
    <span class="n">std</span><span class="o">::</span><span class="n">back_inserter</span><span class="p">(</span><span class="n">temp_index</span><span class="p">)</span> <span class="p">);</span>
  
  <span class="n">CGAL</span><span class="o">::</span><span class="n">hilbert_sort</span> <span class="p">(</span><span class="n">temp_index</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">temp_index</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">Search_traits_d</span><span class="p">(</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span> <span class="p">)</span> <span class="p">;</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">idx</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_index</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
  <span class="p">}</span>
  
  <span class="k">delete</span> <span class="p">[]</span> <span class="n">temp</span><span class="p">;</span>
  <span class="n">temp</span><span class="o">=</span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// [[Rcpp::export]]</span>
<span class="n">Rcpp</span><span class="o">::</span><span class="n">IntegerVector</span> <span class="nf">hilbertSort</span><span class="p">(</span><span class="k">const</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">MatrixXd</span> <span class="o">&amp;</span> <span class="n">A</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">rows</span><span class="p">();</span>
  <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="n">cols</span><span class="p">();</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">idx</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
  
  <span class="n">hilbert_sort_cgal_fun</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">);</span>
  <span class="k">return</span><span class="p">(</span><span class="n">Rcpp</span><span class="o">::</span><span class="n">wrap</span><span class="p">(</span><span class="n">idx</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div> <p>Saving this code as <code class="language-plaintext highlighter-rouge">hilbertSort.cpp</code> and sourcing with Rcpp <code class="language-plaintext highlighter-rouge">Rcpp::sourceCpp("hilbertSort.cpp")</code> makes the function <code class="language-plaintext highlighter-rouge">hilbertSort()</code>. Be aware that this example function example assumes that the observations are stored by column rather than by row, that is as the transpose of the usual <code class="language-plaintext highlighter-rouge">R</code> <code class="language-plaintext highlighter-rouge">matrix</code> or <code class="language-plaintext highlighter-rouge">data.frame</code>.</p> <h2 id="what-next">What next?</h2> <p>Hopefully, there won’t be too much more to this package now that it should autoupdate to the latest version of CGAL.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/WpProj-Package-Is-Live/">WpProj hits CRAN!</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/WpProj-Package-Is-Live/">WpProj hits CRAN!</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/TSP/">The Traveling Salesman Problem: Installing Concorde on Mac Catalina with CPLEX</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/RcppCGAL-back-on-cran/">Rcppcgal Back On Cran</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/bias-variance/">The Bias-Variance Trade-off</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Eric A. Dunipace. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>