<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> WpProj hits CRAN! | Eric A. Dunipace </title> <meta name="author" content="Eric A. Dunipace"> <meta name="description" content="My first package is finally live on CRAN "> <meta name="keywords" content="Dunipace, Eric, optimal, transport, optimal transport, Harvard, UCLA, DGSOM, Berkeley, Stanford, psychiatry, biostats, biostatistics, statistics, stats, machine learning, Zubizarreta, Trippa, Eric Dunipace, causal, inference"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?5b15871aca489a433d98b6c24c83b78b"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ericdunipace.github.io/blog/2024/WpProj-Package-Is-Live/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Eric</span> A. Dunipace </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">WpProj hits CRAN!</h1> <p class="post-meta"> Created in February 02, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This package was quite a mess. It was the first one I’d ever decided to do and filled with naivete and hubris, I thought it would be a good idea to make a package to load all my functions. It definitely took a long time—especially because a lot of the code was adapting someone else’s C++ code to run for my purpose!—but I think it’s not too bad. There are some places I see that would be obvious places to improve the models but required more work than I currently have time to put in, unfortunately.</p> <h2 id="what-does-the-package-do">What does the package do?</h2> <p>Basically, this package was my round about way of re-inventing \(L_p\) regression. Only slightly kidding. The basic idea is as follows.</p> <p>Say you have some arbitrarily complex model, \(f\), that takes covariates \(x\), and generates a set of predictions, call them \(\hat{y}\in \mathcal{Y}\), that follow a distribution \(\mu\), with an empirical counterpart \(\hat{\mu}\). Now say this model is really hard to interpret how the \(x\)’s affect the predictions. Let’s say we have another class of models, \(g\), that are easy to interpret. Say these are linear models that typically have the form \(x\beta\). We will denote predictions from this model as \(\hat{\eta}\) and let them have some unspecified distribution \(\nu\) and empirical counterpart \(\hat{\nu}\). (Note that since the \(x\)’s are considered fixed, the distribution is actually coming from the \(\beta\)’s, i.e. \(x\beta \sim \nu\))</p> <p>It’d be nice if we could use this set of interpretable models from \(g\) to help us understand what’s happening in \(f\). Ideally, these models in \(g\) would be close in some sense to \(f\). We desire</p> <ol> <li>Fidelity: predictions from our \(g\) models should be close to \(f\)</li> <li>Interpretability: we should be able to understand what’s happening in \(g\). This also implies our models can’t have too many coefficients.</li> </ol> <p>Let’s address each of these in turn. For 1, we need some way of ensuring predictive distributions are close to one another. One such metric is the \(p\)-Wasserstein distance, defined as</p> \[W_p(\hat{\mu}, \hat{\nu}) = \left( \inf_\pi \int \|\hat{y} - \hat{\nu}\|^p \pi(d\hat{y}, d\hat{\nu}) \right)^{1/p}.\] <p>Then we seek to minimize \(\inf_\hat{\nu} W_p(\hat{\mu}, \hat{\nu})^p.\)</p> <p>Now, for 2. Since the parameter space of \(\hat{\nu}\) could be quite large if the dimensionality of \(x\) is large, then we might not still have an interpretable model—I’d argue that a 1000 covariate regression model is <strong>not</strong>, in fact, interpretable!</p> <p>Going back to our minimization problem, we want to add some kind of penalty for large parameter distributions</p> \[\inf_\hat{\nu} W_p(\hat{\mu}, \hat{\nu})^p + P_\lambda (\hat{\nu}).\] <p>We should note that \(\hat{\nu} = x \hat{\beta}\). So, we need someway of reducing the dimensionality of the \(x\)’s. But fortunately, for linear models there’s a decades old method of doing just that!</p> <p>Rather than focusing on the \(x\)’s, we focus on reducing the dimensions of \(\beta\) using a penalty like the group Lasso:</p> \[P_\lambda (\beta) = \lambda \| \beta^{(1)} \|_2 + \lambda \|\beta^{(2)}\|_2 + ...\] <p>Finally, if we let the number of atoms in empricical distributions be equal, then the problem will reduce to</p> \[\inf_\beta \sum_i \left\| \hat{y}_i - x \beta_i\right\|_p^p + \lambda \sum_j \left \|\beta^{(j)}\right\|_2.\] <p>Cool!</p> <h2 id="lets-see-an-example">Let’s see an example</h2> <p>Ok, say we have</p> <h3 id="estimating-model">Estimating model</h3> <p>For exposition, we will keep it simple</p> <h3 id="interpretable-model">Interpretable model</h3> <h3 id="performance-evaluation">Performance Evaluation</h3> <ul> <li>example: maybe simple normal model, bayesian</li> <li>then show predictions (how?)</li> <li>then show estimating simpler model</li> <li>show outputs</li> </ul> <h2 id="extensions">Extensions</h2> <p>One obvious extension is to have arbitrary transformations of the preditive function \(x\beta\). This would be useful in the case where we have something like predictions on a probability space and we want our coefficients to be selected such that they do the best job of predicting on that space rather than the linear predictor space:</p> \[\inf_\beta \sum_i \| \hat{y}_i - h(x \beta_i)\|_p^p + ...\] <p>This may also allow the models to have uses in other applications, which hopefully I will be working on soon!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/bias-variance/">The Bias-Variance Trade-off</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/RcppCGAL-updates/">RcppCGAL updated</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/TSP/">The Traveling Salesman Problem: Installing Concorde on Mac Catalina with CPLEX</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/rqpen-bug/">Bug alert in rqPen!</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/DNN-playground/">Deep Neural Network Playground</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Eric A. Dunipace. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>